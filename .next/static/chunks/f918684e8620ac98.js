(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,78894,e=>{"use strict";e.s(["AlertTriangle",()=>t],78894);let t=(0,e.i(75254).default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},67279,e=>{"use strict";e.s(["InventoryForm",()=>g]);var t=e.i(43476),s=e.i(71645),n=e.i(53145),a=e.i(81307),l=e.i(94814),r=e.i(76639),i=e.i(19455),o=e.i(93479),c=e.i(24687),d=e.i(3133),h=e.i(67489),u=e.i(46696),m=e.i(26633);let x=a.z.object({name:a.z.string().min(2,"Tên sản phẩm tối thiểu 2 ký tự"),description:a.z.string().optional(),sku:a.z.string().min(1,"SKU là bắt buộc"),quantity:a.z.string().min(1,"Số lượng là bắt buộc"),minQuantity:a.z.string().min(1,"Số lượng tối thiểu là bắt buộc"),unitPrice:a.z.string().min(1,"Đơn giá là bắt buộc"),warehouseId:a.z.string().min(1,"Vui lòng chọn kho hàng"),category:a.z.string().min(1,"Danh mục là bắt buộc"),supplier:a.z.string().optional(),location:a.z.string().optional()}),p=["Electronics","Clothing","Food & Beverage","Books","Home & Garden","Sports","Toys","Health & Beauty","Automotive","Other"];function g(e){var a,g,j;let{open:f,onClose:v,onSuccess:y,item:b,mode:C}=e,[w,N]=(0,s.useState)(!1),[S,k]=(0,s.useState)([]),F=(0,n.useForm)({resolver:(0,l.zodResolver)(x),defaultValues:{name:(null==b?void 0:b.name)||"",description:(null==b?void 0:b.description)||"",sku:(null==b?void 0:b.sku)||"",quantity:(null==b||null==(a=b.quantity)?void 0:a.toString())||"",minQuantity:(null==b||null==(g=b.minQuantity)?void 0:g.toString())||"",unitPrice:(null==b||null==(j=b.unitPrice)?void 0:j.toString())||"",warehouseId:(null==b?void 0:b.warehouseId)||"",category:(null==b?void 0:b.category)||"",supplier:(null==b?void 0:b.supplier)||"",location:(null==b?void 0:b.location)||""}});(0,s.useEffect)(()=>{let e=async()=>{try{let e=await m.firestoreService.getUserWarehouses();k(e)}catch(e){console.error("Error loading warehouses:",e)}};f&&e()},[f]);let I=async e=>{N(!0);try{if("create"===C){let t={name:e.name,description:e.description||"",sku:e.sku,quantity:parseInt(e.quantity),minQuantity:parseInt(e.minQuantity),unitPrice:parseFloat(e.unitPrice),warehouseId:e.warehouseId,category:e.category,supplier:e.supplier||"",location:e.location||"",ownerId:"",status:"in_stock",updatedBy:""},s={id:await m.firestoreService.addInventoryItem(t),...t,createdAt:new Date,lastUpdated:new Date};u.toast.success("Thêm sản phẩm thành công!"),y(s)}else if("edit"===C&&b){let t={name:e.name,description:e.description||"",sku:e.sku,quantity:parseInt(e.quantity),minQuantity:parseInt(e.minQuantity),unitPrice:parseFloat(e.unitPrice),warehouseId:e.warehouseId,category:e.category,supplier:e.supplier||"",location:e.location||""};await m.firestoreService.updateInventoryItem(b.id,t);let s={...b,...t,lastUpdated:new Date};u.toast.success("Cập nhật sản phẩm thành công!"),y(s)}F.reset(),v()}catch(e){console.error("Inventory form error:",e),u.toast.error("Lỗi: "+e.message)}finally{N(!1)}},D=()=>{F.reset(),v()};return(0,t.jsx)(r.Dialog,{open:f,onOpenChange:D,children:(0,t.jsxs)(r.DialogContent,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(r.DialogHeader,{children:[(0,t.jsx)(r.DialogTitle,{children:"create"===C?"Thêm sản phẩm mới":"Chỉnh sửa sản phẩm"}),(0,t.jsx)(r.DialogDescription,{children:"create"===C?"Điền thông tin để thêm sản phẩm vào kho":"Cập nhật thông tin sản phẩm"})]}),(0,t.jsx)(d.Form,{...F,children:(0,t.jsxs)("form",{onSubmit:F.handleSubmit(I),className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(d.FormField,{control:F.control,name:"name",render:e=>{let{field:s}=e;return(0,t.jsxs)(d.FormItem,{children:[(0,t.jsx)(d.FormLabel,{children:"Tên sản phẩm *"}),(0,t.jsx)(d.FormControl,{children:(0,t.jsx)(o.Input,{placeholder:"iPhone 15 Pro",...s})}),(0,t.jsx)(d.FormMessage,{})]})}}),(0,t.jsx)(d.FormField,{control:F.control,name:"sku",render:e=>{let{field:s}=e;return(0,t.jsxs)(d.FormItem,{children:[(0,t.jsx)(d.FormLabel,{children:"SKU *"}),(0,t.jsx)(d.FormControl,{children:(0,t.jsx)(o.Input,{placeholder:"IP15P-128-BLK",...s})}),(0,t.jsx)(d.FormMessage,{})]})}})]}),(0,t.jsx)(d.FormField,{control:F.control,name:"description",render:e=>{let{field:s}=e;return(0,t.jsxs)(d.FormItem,{children:[(0,t.jsx)(d.FormLabel,{children:"Mô tả"}),(0,t.jsx)(d.FormControl,{children:(0,t.jsx)(c.Textarea,{placeholder:"Mô tả chi tiết về sản phẩm...",...s})}),(0,t.jsx)(d.FormMessage,{})]})}}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(d.FormField,{control:F.control,name:"category",render:e=>{let{field:s}=e;return(0,t.jsxs)(d.FormItem,{children:[(0,t.jsx)(d.FormLabel,{children:"Danh mục *"}),(0,t.jsxs)(h.Select,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,t.jsx)(d.FormControl,{children:(0,t.jsx)(h.SelectTrigger,{children:(0,t.jsx)(h.SelectValue,{placeholder:"Chọn danh mục"})})}),(0,t.jsx)(h.SelectContent,{children:p.map(e=>(0,t.jsx)(h.SelectItem,{value:e,children:e},e))})]}),(0,t.jsx)(d.FormMessage,{})]})}}),(0,t.jsx)(d.FormField,{control:F.control,name:"warehouseId",render:e=>{let{field:s}=e;return(0,t.jsxs)(d.FormItem,{children:[(0,t.jsx)(d.FormLabel,{children:"Kho hàng *"}),(0,t.jsxs)(h.Select,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,t.jsx)(d.FormControl,{children:(0,t.jsx)(h.SelectTrigger,{children:(0,t.jsx)(h.SelectValue,{placeholder:"Chọn kho hàng"})})}),(0,t.jsx)(h.SelectContent,{children:S.map(e=>(0,t.jsx)(h.SelectItem,{value:e.id,children:e.name},e.id))})]}),(0,t.jsx)(d.FormMessage,{})]})}})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsx)(d.FormField,{control:F.control,name:"quantity",render:e=>{let{field:s}=e;return(0,t.jsxs)(d.FormItem,{children:[(0,t.jsx)(d.FormLabel,{children:"Số lượng *"}),(0,t.jsx)(d.FormControl,{children:(0,t.jsx)(o.Input,{type:"number",placeholder:"100",...s})}),(0,t.jsx)(d.FormMessage,{})]})}}),(0,t.jsx)(d.FormField,{control:F.control,name:"minQuantity",render:e=>{let{field:s}=e;return(0,t.jsxs)(d.FormItem,{children:[(0,t.jsx)(d.FormLabel,{children:"Tồn kho tối thiểu *"}),(0,t.jsx)(d.FormControl,{children:(0,t.jsx)(o.Input,{type:"number",placeholder:"10",...s})}),(0,t.jsx)(d.FormMessage,{})]})}}),(0,t.jsx)(d.FormField,{control:F.control,name:"unitPrice",render:e=>{let{field:s}=e;return(0,t.jsxs)(d.FormItem,{children:[(0,t.jsx)(d.FormLabel,{children:"Đơn giá (VND) *"}),(0,t.jsx)(d.FormControl,{children:(0,t.jsx)(o.Input,{type:"number",placeholder:"25000000",...s})}),(0,t.jsx)(d.FormMessage,{})]})}})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(d.FormField,{control:F.control,name:"supplier",render:e=>{let{field:s}=e;return(0,t.jsxs)(d.FormItem,{children:[(0,t.jsx)(d.FormLabel,{children:"Nhà cung cấp"}),(0,t.jsx)(d.FormControl,{children:(0,t.jsx)(o.Input,{placeholder:"Apple Inc.",...s})}),(0,t.jsx)(d.FormMessage,{})]})}}),(0,t.jsx)(d.FormField,{control:F.control,name:"location",render:e=>{let{field:s}=e;return(0,t.jsxs)(d.FormItem,{children:[(0,t.jsx)(d.FormLabel,{children:"Vị trí trong kho"}),(0,t.jsx)(d.FormControl,{children:(0,t.jsx)(o.Input,{placeholder:"A1-B2-C3",...s})}),(0,t.jsx)(d.FormMessage,{})]})}})]}),(0,t.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,t.jsx)(i.Button,{type:"button",variant:"outline",onClick:D,disabled:w,children:"Hủy"}),(0,t.jsx)(i.Button,{type:"submit",disabled:w,children:w?"create"===C?"Đang thêm...":"Đang cập nhật...":"create"===C?"Thêm sản phẩm":"Cập nhật"})]})]})})]})})}},88511,e=>{"use strict";e.s(["Edit",()=>t],88511);let t=(0,e.i(75254).default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},15288,e=>{"use strict";e.s(["Card",()=>n,"CardContent",()=>i,"CardDescription",()=>r,"CardHeader",()=>a,"CardTitle",()=>l]);var t=e.i(43476),s=e.i(75157);function n(e){let{className:n,...a}=e;return(0,t.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",n),...a})}function a(e){let{className:n,...a}=e;return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",n),...a})}function l(e){let{className:n,...a}=e;return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",n),...a})}function r(e){let{className:n,...a}=e;return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",n),...a})}function i(e){let{className:n,...a}=e;return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",n),...a})}},7233,e=>{"use strict";e.s(["Plus",()=>t],7233);let t=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},68499,e=>{"use strict";e.s(["AlertDialog",()=>T,"AlertDialogAction",()=>L,"AlertDialogCancel",()=>q,"AlertDialogContent",()=>P,"AlertDialogDescription",()=>B,"AlertDialogFooter",()=>V,"AlertDialogHeader",()=>H,"AlertDialogTitle",()=>z],68499);var t=e.i(43476),s=e.i(71645),n=e.i(30030),a=e.i(20783),l=e.i(26999),r=e.i(81140),i=e.i(91918),o="AlertDialog",[c,d]=(0,n.createContextScope)(o,[l.createDialogScope]),h=(0,l.createDialogScope)(),u=e=>{let{__scopeAlertDialog:s,...n}=e,a=h(s);return(0,t.jsx)(l.Root,{...a,...n,modal:!0})};u.displayName=o,s.forwardRef((e,s)=>{let{__scopeAlertDialog:n,...a}=e,r=h(n);return(0,t.jsx)(l.Trigger,{...r,...a,ref:s})}).displayName="AlertDialogTrigger";var m=e=>{let{__scopeAlertDialog:s,...n}=e,a=h(s);return(0,t.jsx)(l.Portal,{...a,...n})};m.displayName="AlertDialogPortal";var x=s.forwardRef((e,s)=>{let{__scopeAlertDialog:n,...a}=e,r=h(n);return(0,t.jsx)(l.Overlay,{...r,...a,ref:s})});x.displayName="AlertDialogOverlay";var p="AlertDialogContent",[g,j]=c(p),f=(0,i.createSlottable)("AlertDialogContent"),v=s.forwardRef((e,n)=>{let{__scopeAlertDialog:i,children:o,...c}=e,d=h(i),u=s.useRef(null),m=(0,a.useComposedRefs)(n,u),x=s.useRef(null);return(0,t.jsx)(l.WarningProvider,{contentName:p,titleName:y,docsSlug:"alert-dialog",children:(0,t.jsx)(g,{scope:i,cancelRef:x,children:(0,t.jsxs)(l.Content,{role:"alertdialog",...d,...c,ref:m,onOpenAutoFocus:(0,r.composeEventHandlers)(c.onOpenAutoFocus,e=>{var t;e.preventDefault(),null==(t=x.current)||t.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[(0,t.jsx)(f,{children:o}),(0,t.jsx)(F,{contentRef:u})]})})})});v.displayName=p;var y="AlertDialogTitle",b=s.forwardRef((e,s)=>{let{__scopeAlertDialog:n,...a}=e,r=h(n);return(0,t.jsx)(l.Title,{...r,...a,ref:s})});b.displayName=y;var C="AlertDialogDescription",w=s.forwardRef((e,s)=>{let{__scopeAlertDialog:n,...a}=e,r=h(n);return(0,t.jsx)(l.Description,{...r,...a,ref:s})});w.displayName=C;var N=s.forwardRef((e,s)=>{let{__scopeAlertDialog:n,...a}=e,r=h(n);return(0,t.jsx)(l.Close,{...r,...a,ref:s})});N.displayName="AlertDialogAction";var S="AlertDialogCancel",k=s.forwardRef((e,s)=>{let{__scopeAlertDialog:n,...r}=e,{cancelRef:i}=j(S,n),o=h(n),c=(0,a.useComposedRefs)(s,i);return(0,t.jsx)(l.Close,{...o,...r,ref:c})});k.displayName=S;var F=e=>{let{contentRef:t}=e,n="`".concat(p,"` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the `").concat(p,"` by passing a `").concat(C,"` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an `id` and passing the same value to the `aria-describedby` prop in `").concat(p,"`. If the description is confusing or duplicative for sighted users, you can use the `@radix-ui/react-visually-hidden` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog");return s.useEffect(()=>{var e;document.getElementById(null==(e=t.current)?void 0:e.getAttribute("aria-describedby"))||console.warn(n)},[n,t]),null},I=e.i(75157),D=e.i(19455);function T(e){let{...s}=e;return(0,t.jsx)(u,{"data-slot":"alert-dialog",...s})}function A(e){let{...s}=e;return(0,t.jsx)(m,{"data-slot":"alert-dialog-portal",...s})}function M(e){let{className:s,...n}=e;return(0,t.jsx)(x,{"data-slot":"alert-dialog-overlay",className:(0,I.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...n})}function P(e){let{className:s,...n}=e;return(0,t.jsxs)(A,{children:[(0,t.jsx)(M,{}),(0,t.jsx)(v,{"data-slot":"alert-dialog-content",className:(0,I.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...n})]})}function H(e){let{className:s,...n}=e;return(0,t.jsx)("div",{"data-slot":"alert-dialog-header",className:(0,I.cn)("flex flex-col gap-2 text-center sm:text-left",s),...n})}function V(e){let{className:s,...n}=e;return(0,t.jsx)("div",{"data-slot":"alert-dialog-footer",className:(0,I.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s),...n})}function z(e){let{className:s,...n}=e;return(0,t.jsx)(b,{"data-slot":"alert-dialog-title",className:(0,I.cn)("text-lg font-semibold",s),...n})}function B(e){let{className:s,...n}=e;return(0,t.jsx)(w,{"data-slot":"alert-dialog-description",className:(0,I.cn)("text-muted-foreground text-sm",s),...n})}function L(e){let{className:s,...n}=e;return(0,t.jsx)(N,{className:(0,I.cn)((0,D.buttonVariants)(),s),...n})}function q(e){let{className:s,...n}=e;return(0,t.jsx)(k,{className:(0,I.cn)((0,D.buttonVariants)({variant:"outline"}),s),...n})}},41071,e=>{"use strict";e.s(["MoreHorizontal",()=>t],41071);let t=(0,e.i(75254).default)("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},27612,e=>{"use strict";e.s(["Trash2",()=>t],27612);let t=(0,e.i(75254).default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},87130,e=>{"use strict";e.s(["Filter",()=>t],87130);let t=(0,e.i(75254).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]])},86536,e=>{"use strict";e.s(["Eye",()=>t],86536);let t=(0,e.i(75254).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},91152,e=>{"use strict";e.s(["SortAsc",()=>t],91152);let t=(0,e.i(75254).default)("arrow-up-narrow-wide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]])},61012,e=>{"use strict";e.s(["default",()=>H],61012);var t=e.i(43476),s=e.i(71645),n=e.i(18566),a=e.i(15288),l=e.i(19455),r=e.i(93479),i=e.i(87486),o=e.i(67489),c=e.i(68499),d=e.i(55146),h=e.i(75157);function u(e){let{className:s,...n}=e;return(0,t.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,t.jsx)("table",{"data-slot":"table",className:(0,h.cn)("w-full caption-bottom text-sm",s),...n})})}function m(e){let{className:s,...n}=e;return(0,t.jsx)("thead",{"data-slot":"table-header",className:(0,h.cn)("[&_tr]:border-b",s),...n})}function x(e){let{className:s,...n}=e;return(0,t.jsx)("tbody",{"data-slot":"table-body",className:(0,h.cn)("[&_tr:last-child]:border-0",s),...n})}function p(e){let{className:s,...n}=e;return(0,t.jsx)("tr",{"data-slot":"table-row",className:(0,h.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",s),...n})}function g(e){let{className:s,...n}=e;return(0,t.jsx)("th",{"data-slot":"table-head",className:(0,h.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...n})}function j(e){let{className:s,...n}=e;return(0,t.jsx)("td",{"data-slot":"table-cell",className:(0,h.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",s),...n})}var f=e.i(65033),v=e.i(67279),y=e.i(26633),b=e.i(33277),C=e.i(46696),w=e.i(88844),N=e.i(55436),S=e.i(87130),k=e.i(7233),F=e.i(41071),I=e.i(88511),D=e.i(27612),T=e.i(86536),A=e.i(78894),M=e.i(25652),P=e.i(91152);function H(){let e=(0,n.useRouter)(),[h,H]=(0,s.useState)([]),[V,z]=(0,s.useState)([]),[B,L]=(0,s.useState)(!0),[q,_]=(0,s.useState)(""),[U,R]=(0,s.useState)("all"),[K,O]=(0,s.useState)("all"),[E,Q]=(0,s.useState)("all"),[X,G]=(0,s.useState)("name"),[W,Y]=(0,s.useState)(!1),[Z,J]=(0,s.useState)(null),[$,ee]=(0,s.useState)(null),[et,es]=(0,s.useState)(!1),{userProfile:en}=(0,b.useUser)(),ea=async()=>{try{L(!0);let[e,t]=await Promise.all([y.firestoreService.getAllInventory(),y.firestoreService.getUserWarehouses()]);H(e),z(t)}catch(e){console.error("Error loading inventory:",e),C.toast.error("Lỗi khi tải danh sách hàng hóa")}finally{L(!1)}};(0,s.useEffect)(()=>{ea()},[]);let el=h.filter(e=>{let t=e.name.toLowerCase().includes(q.toLowerCase())||e.sku.toLowerCase().includes(q.toLowerCase())||e.description.toLowerCase().includes(q.toLowerCase()),s="all"===U||e.category===U,n="all"===K||e.status===K,a="all"===E||e.warehouseId===E;return t&&s&&n&&a}).sort((e,t)=>{switch(X){case"name":return e.name.localeCompare(t.name);case"quantity":return t.quantity-e.quantity;case"price":return t.unitPrice-e.unitPrice;case"updated":return new Date(t.lastUpdated).getTime()-new Date(e.lastUpdated).getTime();default:return 0}}),er=()=>{J(null),Y(!0)},ei=async()=>{if($&&!et)try{es(!0),await y.firestoreService.deleteInventoryItem($.id),H(h.filter(e=>e.id!==$.id)),C.toast.success("Xóa sản phẩm thành công!")}catch(e){C.toast.error("Lỗi khi xóa sản phẩm: "+e.message)}finally{es(!1),ee(null)}},eo=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),ec=e=>{let t=V.find(t=>t.id===e);return(null==t?void 0:t.name)||"Không xác định"},ed=[...new Set(h.map(e=>e.category))],eh={total:h.length,inStock:h.filter(e=>"in_stock"===e.status).length,lowStock:h.filter(e=>"low_stock"===e.status).length,outOfStock:h.filter(e=>"out_of_stock"===e.status).length,totalValue:h.reduce((e,t)=>e+t.quantity*t.unitPrice,0)};return B?(0,t.jsx)(f.LoadingState,{message:"Đang tải danh sách hàng hóa..."}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Hàng hóa"}),(0,t.jsxs)("p",{className:"text-muted-foreground",children:["Quản lý tồn kho và sản phẩm (",h.length," sản phẩm)"]})]}),(0,t.jsxs)(l.Button,{onClick:er,children:[(0,t.jsx)(k.Plus,{className:"mr-2 h-4 w-4"}),"Thêm sản phẩm"]})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:[(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium",children:"Tổng sản phẩm"}),(0,t.jsx)(w.Package,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:eh.total}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[el.length!==eh.total&&"".concat(el.length," hiển thị"),el.length===eh.total&&"Trong tất cả kho"]})]})]}),(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium",children:"Còn hàng"}),(0,t.jsx)(w.Package,{className:"h-4 w-4 text-green-600"})]}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600",children:eh.inStock}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[eh.total>0?(eh.inStock/eh.total*100).toFixed(1):0,"% tổng số"]})]})]}),(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium",children:"Sắp hết"}),(0,t.jsx)(A.AlertTriangle,{className:"h-4 w-4 text-yellow-600"})]}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:eh.lowStock}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Cần nhập thêm hàng"})]})]}),(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium",children:"Hết hàng"}),(0,t.jsx)(w.Package,{className:"h-4 w-4 text-red-600"})]}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-red-600",children:eh.outOfStock}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Cần nhập hàng gấp"})]})]}),(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(a.CardTitle,{className:"text-sm font-medium",children:"Giá trị tồn kho"}),(0,t.jsx)(M.TrendingUp,{className:"h-4 w-4 text-blue-600"})]}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:eo(eh.totalValue)}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Tổng giá trị hàng tồn"})]})]})]}),(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{children:[(0,t.jsx)(a.CardTitle,{children:"Danh sách sản phẩm"}),(0,t.jsx)(a.CardDescription,{children:"Quản lý và theo dõi tình trạng hàng hóa"})]}),(0,t.jsxs)(a.CardContent,{children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-4",children:[(0,t.jsxs)("div",{className:"relative flex-1 max-w-sm",children:[(0,t.jsx)(N.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),(0,t.jsx)(r.Input,{placeholder:"Tìm kiếm sản phẩm, SKU...",value:q,onChange:e=>_(e.target.value),className:"pl-10"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(o.Select,{value:U,onValueChange:R,children:[(0,t.jsxs)(o.SelectTrigger,{className:"w-[140px]",children:[(0,t.jsx)(S.Filter,{className:"h-4 w-4 mr-2"}),(0,t.jsx)(o.SelectValue,{placeholder:"Danh mục"})]}),(0,t.jsxs)(o.SelectContent,{children:[(0,t.jsx)(o.SelectItem,{value:"all",children:"Tất cả"}),ed.map(e=>(0,t.jsx)(o.SelectItem,{value:e,children:e},e))]})]}),(0,t.jsxs)(o.Select,{value:K,onValueChange:O,children:[(0,t.jsx)(o.SelectTrigger,{className:"w-[120px]",children:(0,t.jsx)(o.SelectValue,{placeholder:"Trạng thái"})}),(0,t.jsxs)(o.SelectContent,{children:[(0,t.jsx)(o.SelectItem,{value:"all",children:"Tất cả"}),(0,t.jsx)(o.SelectItem,{value:"in_stock",children:"Còn hàng"}),(0,t.jsx)(o.SelectItem,{value:"low_stock",children:"Sắp hết"}),(0,t.jsx)(o.SelectItem,{value:"out_of_stock",children:"Hết hàng"})]})]}),(0,t.jsxs)(o.Select,{value:E,onValueChange:Q,children:[(0,t.jsx)(o.SelectTrigger,{className:"w-[140px]",children:(0,t.jsx)(o.SelectValue,{placeholder:"Kho hàng"})}),(0,t.jsxs)(o.SelectContent,{children:[(0,t.jsx)(o.SelectItem,{value:"all",children:"Tất cả kho"}),V.map(e=>(0,t.jsx)(o.SelectItem,{value:e.id,children:e.name},e.id))]})]}),(0,t.jsxs)(o.Select,{value:X,onValueChange:G,children:[(0,t.jsxs)(o.SelectTrigger,{className:"w-[120px]",children:[(0,t.jsx)(P.SortAsc,{className:"h-4 w-4 mr-2"}),(0,t.jsx)(o.SelectValue,{placeholder:"Sắp xếp"})]}),(0,t.jsxs)(o.SelectContent,{children:[(0,t.jsx)(o.SelectItem,{value:"name",children:"Tên A-Z"}),(0,t.jsx)(o.SelectItem,{value:"quantity",children:"Số lượng"}),(0,t.jsx)(o.SelectItem,{value:"price",children:"Giá cao"}),(0,t.jsx)(o.SelectItem,{value:"updated",children:"Mới cập nhật"})]})]})]})]}),0===el.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(w.Package,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium mb-2",children:q||"all"!==U||"all"!==K||"all"!==E?"Không tìm thấy sản phẩm":"Chưa có sản phẩm"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-4",children:q||"all"!==U||"all"!==K||"all"!==E?"Thử thay đổi bộ lọc hoặc từ khóa tìm kiếm":"Thêm sản phẩm đầu tiên vào kho hàng"}),!q&&"all"===U&&"all"===K&&"all"===E&&(0,t.jsxs)(l.Button,{onClick:er,children:[(0,t.jsx)(k.Plus,{className:"mr-2 h-4 w-4"}),"Thêm sản phẩm đầu tiên"]})]}):(0,t.jsxs)(u,{children:[(0,t.jsx)(m,{children:(0,t.jsxs)(p,{children:[(0,t.jsx)(g,{children:"Sản phẩm"}),(0,t.jsx)(g,{children:"SKU"}),(0,t.jsx)(g,{children:"Danh mục"}),(0,t.jsx)(g,{children:"Số lượng"}),(0,t.jsx)(g,{children:"Đơn giá"}),(0,t.jsx)(g,{children:"Kho hàng"}),(0,t.jsx)(g,{children:"Trạng thái"}),(0,t.jsx)(g,{children:"Cập nhật"}),(0,t.jsx)(g,{className:"text-right",children:"Thao tác"})]})}),(0,t.jsx)(x,{children:el.map(s=>{var n;return(0,t.jsxs)(p,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>e.push("/dashboard/inventory/".concat(s.id)),children:[(0,t.jsx)(j,{children:(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-medium",children:s.name}),s.description&&(0,t.jsx)("div",{className:"text-sm text-muted-foreground line-clamp-1",children:s.description})]})}),(0,t.jsx)(j,{className:"font-mono text-sm",children:s.sku}),(0,t.jsx)(j,{children:s.category}),(0,t.jsx)(j,{children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"font-medium",children:s.quantity}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Min: ",s.minQuantity]})]})}),(0,t.jsx)(j,{children:eo(s.unitPrice)}),(0,t.jsx)(j,{children:ec(s.warehouseId)}),(0,t.jsx)(j,{children:(e=>{switch(e){case"in_stock":return(0,t.jsx)(i.Badge,{variant:"default",className:"bg-green-100 text-green-800",children:"Còn hàng"});case"low_stock":return(0,t.jsx)(i.Badge,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:"Sắp hết"});case"out_of_stock":return(0,t.jsx)(i.Badge,{variant:"destructive",children:"Hết hàng"});default:return(0,t.jsx)(i.Badge,{variant:"outline",children:"Không xác định"})}})(s.status)}),(0,t.jsx)(j,{children:s.lastUpdated.toLocaleDateString("vi-VN")}),(0,t.jsx)(j,{className:"text-right",children:(0,t.jsxs)(d.DropdownMenu,{children:[(0,t.jsx)(d.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(l.Button,{variant:"ghost",size:"sm",children:(0,t.jsx)(F.MoreHorizontal,{className:"h-4 w-4"})})}),(0,t.jsxs)(d.DropdownMenuContent,{align:"end",children:[(0,t.jsxs)(d.DropdownMenuItem,{onClick:t=>{t.stopPropagation(),e.push("/dashboard/inventory/".concat(s.id))},children:[(0,t.jsx)(T.Eye,{className:"mr-2 h-4 w-4"}),"Xem chi tiết"]}),(0,t.jsxs)(d.DropdownMenuItem,{onClick:e=>{e.stopPropagation(),J(s),Y(!0)},children:[(0,t.jsx)(I.Edit,{className:"mr-2 h-4 w-4"}),"Chỉnh sửa"]}),((null==en?void 0:en.role)==="admin"||(null==en||null==(n=en.permissions)?void 0:n.canManageInventory))&&(0,t.jsxs)(d.DropdownMenuItem,{onClick:e=>{e.stopPropagation(),ee(s)},className:"text-red-600",children:[(0,t.jsx)(D.Trash2,{className:"mr-2 h-4 w-4"}),"Xóa"]})]})]})})]},s.id)})})]})]})]}),h.length>0&&(0,t.jsxs)(a.Card,{children:[(0,t.jsxs)(a.CardHeader,{children:[(0,t.jsx)(a.CardTitle,{children:"Thao tác nhanh"}),(0,t.jsx)(a.CardDescription,{children:"Các tác vụ thường dùng để quản lý hàng hóa"})]}),(0,t.jsx)(a.CardContent,{children:(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,t.jsxs)(l.Button,{variant:"outline",className:"h-20 flex-col space-y-2",onClick:er,children:[(0,t.jsx)(k.Plus,{className:"h-6 w-6"}),(0,t.jsx)("span",{children:"Thêm sản phẩm"})]}),(0,t.jsxs)(l.Button,{variant:"outline",className:"h-20 flex-col space-y-2",onClick:()=>O("low_stock"),children:[(0,t.jsx)(A.AlertTriangle,{className:"h-6 w-6"}),(0,t.jsx)("span",{children:"Sản phẩm sắp hết"})]}),(0,t.jsxs)(l.Button,{variant:"outline",className:"h-20 flex-col space-y-2",onClick:()=>O("out_of_stock"),children:[(0,t.jsx)(w.Package,{className:"h-6 w-6"}),(0,t.jsx)("span",{children:"Hàng hết tồn"})]}),(0,t.jsxs)(l.Button,{variant:"outline",className:"h-20 flex-col space-y-2",onClick:()=>e.push("/dashboard/reports"),children:[(0,t.jsx)(M.TrendingUp,{className:"h-6 w-6"}),(0,t.jsx)("span",{children:"Báo cáo tồn kho"})]})]})})]}),(0,t.jsx)(v.InventoryForm,{open:W,onClose:()=>Y(!1),onSuccess:e=>{Z?H(h.map(t=>t.id===e.id?e:t)):H([e,...h])},item:Z,mode:Z?"edit":"create"}),(0,t.jsx)(c.AlertDialog,{open:!!$,onOpenChange:()=>ee(null),children:(0,t.jsxs)(c.AlertDialogContent,{children:[(0,t.jsxs)(c.AlertDialogHeader,{children:[(0,t.jsx)(c.AlertDialogTitle,{children:"Xác nhận xóa sản phẩm"}),(0,t.jsxs)(c.AlertDialogDescription,{children:['Bạn có chắc chắn muốn xóa sản phẩm "',null==$?void 0:$.name,'" (SKU: ',null==$?void 0:$.sku,")?",(0,t.jsx)("br",{}),(0,t.jsx)("br",{}),(0,t.jsx)("strong",{children:"Thông tin sản phẩm:"}),(0,t.jsx)("br",{}),"• Số lượng hiện tại: ",null==$?void 0:$.quantity,(0,t.jsx)("br",{}),"• Kho hàng: ",ec((null==$?void 0:$.warehouseId)||""),(0,t.jsx)("br",{}),(0,t.jsx)("br",{}),"Hành động này không thể hoàn tác."]})]}),(0,t.jsxs)(c.AlertDialogFooter,{children:[(0,t.jsx)(c.AlertDialogCancel,{disabled:et,children:"Hủy"}),(0,t.jsx)(c.AlertDialogAction,{onClick:ei,disabled:et,className:"bg-red-600 hover:bg-red-700",children:et?"Đang xóa...":"Xóa"})]})]})})]})}}]);