module.exports=[90017,a=>{"use strict";a.s(["default",()=>F]);var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(91119),f=a.i(99570),g=a.i(66718),h=a.i(86304),i=a.i(80701),j=a.i(86192),k=a.i(35732),l=a.i(76243),m=a.i(32450),n=a.i(77929),o=a.i(35475),p=a.i(23292),q=a.i(70893),r=a.i(24987),s=a.i(60246),t=a.i(83497),u=a.i(15618),v=a.i(87532),w=a.i(17755),x=a.i(24569),y=a.i(81560),z=a.i(77156),A=a.i(63519),B=a.i(92258),C=a.i(90669),D=a.i(69012),E=a.i(77786);function F(){let a=(0,d.useRouter)(),[F,G]=(0,c.useState)([]),[H,I]=(0,c.useState)(!0),[J,K]=(0,c.useState)(""),[L,M]=(0,c.useState)("all"),[N,O]=(0,c.useState)("name"),[P,Q]=(0,c.useState)(!1),[R,S]=(0,c.useState)(null),[T,U]=(0,c.useState)(null),[V,W]=(0,c.useState)(!1),{userProfile:X}=(0,o.useUser)(),Y=async()=>{try{I(!0);let a=await n.firestoreService.getUserWarehouses();G(a)}catch(a){console.error("Error loading warehouses:",a),p.toast.error("Lỗi khi tải danh sách kho hàng")}finally{I(!1)}};(0,c.useEffect)(()=>{Y()},[]);let Z=F.filter(a=>{let b=a.name.toLowerCase().includes(J.toLowerCase())||a.address.toLowerCase().includes(J.toLowerCase()),c="all"===L||a.status===L;return b&&c}).sort((a,b)=>{switch(N){case"name":return a.name.localeCompare(b.name);case"capacity":return b.capacity-a.capacity;case"usage":return b.currentStock/b.capacity-a.currentStock/a.capacity;case"created":return new Date(b.createdAt).getTime()-new Date(a.createdAt).getTime();default:return 0}}),$=()=>{S(null),Q(!0)},_=b=>{a.push(`/dashboard/warehouses/${b.id}`)},aa=async()=>{if(T&&!V)try{W(!0);let a=await n.firestoreService.getWarehouseInventory(T.id);if(a.length>0){p.toast.error(`Kh\xf4ng thể x\xf3a kho h\xe0ng c\xf3 ${a.length} sản phẩm. Vui l\xf2ng di chuyển hoặc x\xf3a tất cả sản phẩm trước.`),U(null);return}await n.firestoreService.deleteWarehouse(T.id),G(F.filter(a=>a.id!==T.id)),p.toast.success("Xóa kho hàng thành công!")}catch(a){p.toast.error("Lỗi khi xóa kho hàng: "+a.message)}finally{W(!1),U(null)}};return H?(0,b.jsx)(l.LoadingState,{message:"Đang tải danh sách kho hàng..."}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Kho hàng"}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:["Quản lý các kho hàng trong hệ thống (",F.length," kho)"]})]}),(0,b.jsxs)(f.Button,{onClick:$,children:[(0,b.jsx)(u.Plus,{className:"mr-2 h-4 w-4"}),"Thêm kho hàng"]})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:"Tổng kho hàng"}),(0,b.jsx)(q.Warehouse,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:F.length}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[Z.length!==F.length&&`${Z.length} hiển thị`,Z.length===F.length&&"Trong hệ thống"]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:"Đang hoạt động"}),(0,b.jsx)(C.Activity,{className:"h-4 w-4 text-green-600"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-600",children:F.filter(a=>"active"===a.status).length}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[F.filter(a=>"inactive"===a.status).length," tạm dừng, ",F.filter(a=>"maintenance"===a.status).length," bảo trì"]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:"Tổng sức chứa"}),(0,b.jsx)(t.Package,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold",children:[F.reduce((a,b)=>a+b.capacity,0).toLocaleString()," m²"]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Trung bình ",F.length>0?Math.round(F.reduce((a,b)=>a+b.capacity,0)/F.length).toLocaleString():0," m²/kho"]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:"Tỷ lệ sử dụng"}),(0,b.jsx)(t.Package,{className:"h-4 w-4 text-blue-600"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:[F.length>0?(F.reduce((a,b)=>a+b.currentStock,0)/F.reduce((a,b)=>a+b.capacity,0)*100).toFixed(1):0,"%"]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[F.reduce((a,b)=>a+b.currentStock,0).toLocaleString()," / ",F.reduce((a,b)=>a+b.capacity,0).toLocaleString()," m²"]})]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,b.jsxs)("div",{className:"relative flex-1 max-w-sm",children:[(0,b.jsx)(v.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),(0,b.jsx)(g.Input,{placeholder:"Tìm kiếm kho hàng...",value:J,onChange:a=>K(a.target.value),className:"pl-10"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(i.Select,{value:L,onValueChange:M,children:[(0,b.jsxs)(i.SelectTrigger,{className:"w-[140px]",children:[(0,b.jsx)(D.Filter,{className:"h-4 w-4 mr-2"}),(0,b.jsx)(i.SelectValue,{placeholder:"Trạng thái"})]}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"all",children:"Tất cả"}),(0,b.jsx)(i.SelectItem,{value:"active",children:"Hoạt động"}),(0,b.jsx)(i.SelectItem,{value:"inactive",children:"Tạm dừng"}),(0,b.jsx)(i.SelectItem,{value:"maintenance",children:"Bảo trì"})]})]}),(0,b.jsxs)(i.Select,{value:N,onValueChange:O,children:[(0,b.jsxs)(i.SelectTrigger,{className:"w-[140px]",children:[(0,b.jsx)(E.SortAsc,{className:"h-4 w-4 mr-2"}),(0,b.jsx)(i.SelectValue,{placeholder:"Sắp xếp"})]}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"name",children:"Tên A-Z"}),(0,b.jsx)(i.SelectItem,{value:"capacity",children:"Sức chứa"}),(0,b.jsx)(i.SelectItem,{value:"usage",children:"Tỷ lệ sử dụng"}),(0,b.jsx)(i.SelectItem,{value:"created",children:"Mới nhất"})]})]})]})]}),0===Z.length?(0,b.jsx)(e.Card,{children:(0,b.jsxs)(e.CardContent,{className:"text-center py-12",children:[(0,b.jsx)(q.Warehouse,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium mb-2",children:J?"Không tìm thấy kho hàng":"Chưa có kho hàng"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:J?"Thử tìm kiếm với từ khóa khác":"Tạo kho hàng đầu tiên để bắt đầu quản lý"}),!J&&(0,b.jsxs)(f.Button,{onClick:$,children:[(0,b.jsx)(u.Plus,{className:"mr-2 h-4 w-4"}),"Tạo kho hàng đầu tiên"]})]})}):(0,b.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:Z.map(a=>(0,b.jsxs)(e.Card,{className:"hover:shadow-md transition-shadow cursor-pointer",onClick:()=>_(a),children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(e.CardTitle,{className:"text-lg",children:a.name}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(a=>{switch(a){case"active":return(0,b.jsx)(h.Badge,{variant:"default",className:"bg-green-100 text-green-800",children:"Hoạt động"});case"inactive":return(0,b.jsx)(h.Badge,{variant:"secondary",children:"Tạm dừng"});case"maintenance":return(0,b.jsx)(h.Badge,{variant:"outline",className:"border-yellow-500 text-yellow-700",children:"Bảo trì"});default:return(0,b.jsx)(h.Badge,{variant:"outline",children:"Không xác định"})}})(a.status),(0,b.jsxs)(k.DropdownMenu,{children:[(0,b.jsx)(k.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",onClick:a=>a.stopPropagation(),children:(0,b.jsx)(w.MoreHorizontal,{className:"h-4 w-4"})})}),(0,b.jsxs)(k.DropdownMenuContent,{align:"end",children:[(0,b.jsxs)(k.DropdownMenuItem,{onClick:b=>{b.stopPropagation(),_(a)},children:[(0,b.jsx)(z.Eye,{className:"mr-2 h-4 w-4"}),"Xem chi tiết"]}),(0,b.jsxs)(k.DropdownMenuItem,{onClick:b=>{b.stopPropagation(),S(a),Q(!0)},children:[(0,b.jsx)(x.Edit,{className:"mr-2 h-4 w-4"}),"Chỉnh sửa"]}),(X?.role==="admin"||a.ownerId===X?.uid)&&(0,b.jsxs)(k.DropdownMenuItem,{onClick:b=>{b.stopPropagation(),U(a)},className:"text-red-600",children:[(0,b.jsx)(y.Trash2,{className:"mr-2 h-4 w-4"}),"Xóa"]})]})]})]})]}),(0,b.jsxs)(e.CardDescription,{className:"flex items-center",children:[(0,b.jsx)(r.MapPin,{className:"mr-1 h-3 w-3"}),a.address]})]}),(0,b.jsxs)(e.CardContent,{className:"space-y-4",children:[(a.phone||a.email)&&(0,b.jsxs)("div",{className:"space-y-1 text-sm",children:[a.phone&&(0,b.jsxs)("div",{className:"flex items-center text-muted-foreground",children:[(0,b.jsx)(A.Phone,{className:"mr-2 h-3 w-3"}),a.phone]}),a.email&&(0,b.jsxs)("div",{className:"flex items-center text-muted-foreground",children:[(0,b.jsx)(B.Mail,{className:"mr-2 h-3 w-3"}),a.email]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(t.Package,{className:"mr-2 h-4 w-4 text-muted-foreground"}),(0,b.jsxs)("span",{children:[a.totalItems||0," sản phẩm"]})]}),(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsx)(s.Users,{className:"mr-2 h-4 w-4 text-muted-foreground"}),(0,b.jsxs)("span",{children:[a.managers.length," quản lý"]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,b.jsx)("span",{children:"Sức chứa"}),(0,b.jsxs)("span",{children:[a.currentStock,"/",a.capacity," m²"]})]}),(0,b.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,b.jsx)("div",{className:`h-2 rounded-full ${((a,b)=>{let c=a/b*100;return c>=90?"bg-red-500":c>=70?"bg-yellow-500":"bg-green-500"})(a.currentStock,a.capacity)}`,style:{width:`${Math.min(a.currentStock/a.capacity*100,100)}%`}})}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[(a.currentStock/a.capacity*100).toFixed(1),"% đã sử dụng"]})]}),a.description&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2",children:a.description})]})]},a.id))}),F.length>0&&(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Thao tác nhanh"}),(0,b.jsx)(e.CardDescription,{children:"Các tác vụ thường dùng để quản lý kho hàng"})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)(f.Button,{variant:"outline",className:"h-20 flex-col space-y-2",onClick:$,children:[(0,b.jsx)(u.Plus,{className:"h-6 w-6"}),(0,b.jsx)("span",{children:"Thêm kho mới"})]}),(0,b.jsxs)(f.Button,{variant:"outline",className:"h-20 flex-col space-y-2",onClick:()=>a.push("/dashboard/inventory"),children:[(0,b.jsx)(t.Package,{className:"h-6 w-6"}),(0,b.jsx)("span",{children:"Quản lý hàng hóa"})]}),(0,b.jsxs)(f.Button,{variant:"outline",className:"h-20 flex-col space-y-2",onClick:()=>a.push("/dashboard/reports"),children:[(0,b.jsx)(C.Activity,{className:"h-6 w-6"}),(0,b.jsx)("span",{children:"Báo cáo kho"})]}),(0,b.jsxs)(f.Button,{variant:"outline",className:"h-20 flex-col space-y-2",onClick:()=>M("maintenance"),children:[(0,b.jsx)(D.Filter,{className:"h-6 w-6"}),(0,b.jsx)("span",{children:"Kho bảo trì"})]})]})})]}),(0,b.jsx)(m.WarehouseForm,{open:P,onClose:()=>Q(!1),onSuccess:a=>{R?G(F.map(b=>b.id===a.id?a:b)):G([a,...F])},warehouse:R,mode:R?"edit":"create"}),(0,b.jsx)(j.AlertDialog,{open:!!T,onOpenChange:()=>U(null),children:(0,b.jsxs)(j.AlertDialogContent,{children:[(0,b.jsxs)(j.AlertDialogHeader,{children:[(0,b.jsx)(j.AlertDialogTitle,{children:"Xác nhận xóa kho hàng"}),(0,b.jsxs)(j.AlertDialogDescription,{children:['Bạn có chắc chắn muốn xóa kho hàng "',T?.name,'"?',(0,b.jsx)("br",{}),(0,b.jsx)("br",{}),(0,b.jsx)("strong",{children:"Lưu ý:"})," Kho hàng chỉ có thể xóa khi không còn sản phẩm nào bên trong. Hành động này không thể hoàn tác."]})]}),(0,b.jsxs)(j.AlertDialogFooter,{children:[(0,b.jsx)(j.AlertDialogCancel,{disabled:V,children:"Hủy"}),(0,b.jsx)(j.AlertDialogAction,{onClick:aa,disabled:V,className:"bg-red-600 hover:bg-red-700",children:V?"Đang xóa...":"Xóa"})]})]})})]})}}];

//# sourceMappingURL=src_app_dashboard_warehouses_page_tsx_02b1f2d3._.js.map