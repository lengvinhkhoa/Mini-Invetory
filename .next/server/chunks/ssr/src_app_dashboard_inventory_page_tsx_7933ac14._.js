module.exports=[92532,a=>{"use strict";a.s(["default",()=>I],92532);var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(91119),f=a.i(99570),g=a.i(66718),h=a.i(86304),i=a.i(80701),j=a.i(86192),k=a.i(35732),l=a.i(68114);function m({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,b.jsx)("table",{"data-slot":"table",className:(0,l.cn)("w-full caption-bottom text-sm",a),...c})})}function n({className:a,...c}){return(0,b.jsx)("thead",{"data-slot":"table-header",className:(0,l.cn)("[&_tr]:border-b",a),...c})}function o({className:a,...c}){return(0,b.jsx)("tbody",{"data-slot":"table-body",className:(0,l.cn)("[&_tr:last-child]:border-0",a),...c})}function p({className:a,...c}){return(0,b.jsx)("tr",{"data-slot":"table-row",className:(0,l.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",a),...c})}function q({className:a,...c}){return(0,b.jsx)("th",{"data-slot":"table-head",className:(0,l.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...c})}function r({className:a,...c}){return(0,b.jsx)("td",{"data-slot":"table-cell",className:(0,l.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...c})}var s=a.i(76243),t=a.i(88307),u=a.i(77929),v=a.i(35475),w=a.i(23292),x=a.i(83497),y=a.i(87532),z=a.i(69012),A=a.i(15618),B=a.i(17755),C=a.i(24569),D=a.i(81560),E=a.i(77156),F=a.i(73570),G=a.i(24669),H=a.i(77786);function I(){let a=(0,d.useRouter)(),[l,I]=(0,c.useState)([]),[J,K]=(0,c.useState)([]),[L,M]=(0,c.useState)(!0),[N,O]=(0,c.useState)(""),[P,Q]=(0,c.useState)("all"),[R,S]=(0,c.useState)("all"),[T,U]=(0,c.useState)("all"),[V,W]=(0,c.useState)("name"),[X,Y]=(0,c.useState)(!1),[Z,$]=(0,c.useState)(null),[_,aa]=(0,c.useState)(null),[ab,ac]=(0,c.useState)(!1),{userProfile:ad}=(0,v.useUser)(),ae=async()=>{try{M(!0);let[a,b]=await Promise.all([u.firestoreService.getAllInventory(),u.firestoreService.getUserWarehouses()]);I(a),K(b)}catch(a){console.error("Error loading inventory:",a),w.toast.error("Lỗi khi tải danh sách hàng hóa")}finally{M(!1)}};(0,c.useEffect)(()=>{ae()},[]);let af=l.filter(a=>{let b=a.name.toLowerCase().includes(N.toLowerCase())||a.sku.toLowerCase().includes(N.toLowerCase())||a.description.toLowerCase().includes(N.toLowerCase()),c="all"===P||a.category===P,d="all"===R||a.status===R,e="all"===T||a.warehouseId===T;return b&&c&&d&&e}).sort((a,b)=>{switch(V){case"name":return a.name.localeCompare(b.name);case"quantity":return b.quantity-a.quantity;case"price":return b.unitPrice-a.unitPrice;case"updated":return new Date(b.lastUpdated).getTime()-new Date(a.lastUpdated).getTime();default:return 0}}),ag=()=>{$(null),Y(!0)},ah=async()=>{if(_&&!ab)try{ac(!0),await u.firestoreService.deleteInventoryItem(_.id),I(l.filter(a=>a.id!==_.id)),w.toast.success("Xóa sản phẩm thành công!")}catch(a){w.toast.error("Lỗi khi xóa sản phẩm: "+a.message)}finally{ac(!1),aa(null)}},ai=a=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(a),aj=a=>{let b=J.find(b=>b.id===a);return b?.name||"Không xác định"},ak=[...new Set(l.map(a=>a.category))],al={total:l.length,inStock:l.filter(a=>"in_stock"===a.status).length,lowStock:l.filter(a=>"low_stock"===a.status).length,outOfStock:l.filter(a=>"out_of_stock"===a.status).length,totalValue:l.reduce((a,b)=>a+b.quantity*b.unitPrice,0)};return L?(0,b.jsx)(s.LoadingState,{message:"Đang tải danh sách hàng hóa..."}):(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Hàng hóa"}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:["Quản lý tồn kho và sản phẩm (",l.length," sản phẩm)"]})]}),(0,b.jsxs)(f.Button,{onClick:ag,children:[(0,b.jsx)(A.Plus,{className:"mr-2 h-4 w-4"}),"Thêm sản phẩm"]})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:[(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:"Tổng sản phẩm"}),(0,b.jsx)(x.Package,{className:"h-4 w-4 text-muted-foreground"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:al.total}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[af.length!==al.total&&`${af.length} hiển thị`,af.length===al.total&&"Trong tất cả kho"]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:"Còn hàng"}),(0,b.jsx)(x.Package,{className:"h-4 w-4 text-green-600"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-green-600",children:al.inStock}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[al.total>0?(al.inStock/al.total*100).toFixed(1):0,"% tổng số"]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:"Sắp hết"}),(0,b.jsx)(F.AlertTriangle,{className:"h-4 w-4 text-yellow-600"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:al.lowStock}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Cần nhập thêm hàng"})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:"Hết hàng"}),(0,b.jsx)(x.Package,{className:"h-4 w-4 text-red-600"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-red-600",children:al.outOfStock}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Cần nhập hàng gấp"})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(e.CardTitle,{className:"text-sm font-medium",children:"Giá trị tồn kho"}),(0,b.jsx)(G.TrendingUp,{className:"h-4 w-4 text-blue-600"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:ai(al.totalValue)}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Tổng giá trị hàng tồn"})]})]})]}),(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Danh sách sản phẩm"}),(0,b.jsx)(e.CardDescription,{children:"Quản lý và theo dõi tình trạng hàng hóa"})]}),(0,b.jsxs)(e.CardContent,{children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-4",children:[(0,b.jsxs)("div",{className:"relative flex-1 max-w-sm",children:[(0,b.jsx)(y.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),(0,b.jsx)(g.Input,{placeholder:"Tìm kiếm sản phẩm, SKU...",value:N,onChange:a=>O(a.target.value),className:"pl-10"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(i.Select,{value:P,onValueChange:Q,children:[(0,b.jsxs)(i.SelectTrigger,{className:"w-[140px]",children:[(0,b.jsx)(z.Filter,{className:"h-4 w-4 mr-2"}),(0,b.jsx)(i.SelectValue,{placeholder:"Danh mục"})]}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"all",children:"Tất cả"}),ak.map(a=>(0,b.jsx)(i.SelectItem,{value:a,children:a},a))]})]}),(0,b.jsxs)(i.Select,{value:R,onValueChange:S,children:[(0,b.jsx)(i.SelectTrigger,{className:"w-[120px]",children:(0,b.jsx)(i.SelectValue,{placeholder:"Trạng thái"})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"all",children:"Tất cả"}),(0,b.jsx)(i.SelectItem,{value:"in_stock",children:"Còn hàng"}),(0,b.jsx)(i.SelectItem,{value:"low_stock",children:"Sắp hết"}),(0,b.jsx)(i.SelectItem,{value:"out_of_stock",children:"Hết hàng"})]})]}),(0,b.jsxs)(i.Select,{value:T,onValueChange:U,children:[(0,b.jsx)(i.SelectTrigger,{className:"w-[140px]",children:(0,b.jsx)(i.SelectValue,{placeholder:"Kho hàng"})}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"all",children:"Tất cả kho"}),J.map(a=>(0,b.jsx)(i.SelectItem,{value:a.id,children:a.name},a.id))]})]}),(0,b.jsxs)(i.Select,{value:V,onValueChange:W,children:[(0,b.jsxs)(i.SelectTrigger,{className:"w-[120px]",children:[(0,b.jsx)(H.SortAsc,{className:"h-4 w-4 mr-2"}),(0,b.jsx)(i.SelectValue,{placeholder:"Sắp xếp"})]}),(0,b.jsxs)(i.SelectContent,{children:[(0,b.jsx)(i.SelectItem,{value:"name",children:"Tên A-Z"}),(0,b.jsx)(i.SelectItem,{value:"quantity",children:"Số lượng"}),(0,b.jsx)(i.SelectItem,{value:"price",children:"Giá cao"}),(0,b.jsx)(i.SelectItem,{value:"updated",children:"Mới cập nhật"})]})]})]})]}),0===af.length?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)(x.Package,{className:"mx-auto h-12 w-12 text-muted-foreground mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-medium mb-2",children:N||"all"!==P||"all"!==R||"all"!==T?"Không tìm thấy sản phẩm":"Chưa có sản phẩm"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-4",children:N||"all"!==P||"all"!==R||"all"!==T?"Thử thay đổi bộ lọc hoặc từ khóa tìm kiếm":"Thêm sản phẩm đầu tiên vào kho hàng"}),!N&&"all"===P&&"all"===R&&"all"===T&&(0,b.jsxs)(f.Button,{onClick:ag,children:[(0,b.jsx)(A.Plus,{className:"mr-2 h-4 w-4"}),"Thêm sản phẩm đầu tiên"]})]}):(0,b.jsxs)(m,{children:[(0,b.jsx)(n,{children:(0,b.jsxs)(p,{children:[(0,b.jsx)(q,{children:"Sản phẩm"}),(0,b.jsx)(q,{children:"SKU"}),(0,b.jsx)(q,{children:"Danh mục"}),(0,b.jsx)(q,{children:"Số lượng"}),(0,b.jsx)(q,{children:"Đơn giá"}),(0,b.jsx)(q,{children:"Kho hàng"}),(0,b.jsx)(q,{children:"Trạng thái"}),(0,b.jsx)(q,{children:"Cập nhật"}),(0,b.jsx)(q,{className:"text-right",children:"Thao tác"})]})}),(0,b.jsx)(o,{children:af.map(c=>(0,b.jsxs)(p,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>a.push(`/dashboard/inventory/${c.id}`),children:[(0,b.jsx)(r,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"font-medium",children:c.name}),c.description&&(0,b.jsx)("div",{className:"text-sm text-muted-foreground line-clamp-1",children:c.description})]})}),(0,b.jsx)(r,{className:"font-mono text-sm",children:c.sku}),(0,b.jsx)(r,{children:c.category}),(0,b.jsx)(r,{children:(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"font-medium",children:c.quantity}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:["Min: ",c.minQuantity]})]})}),(0,b.jsx)(r,{children:ai(c.unitPrice)}),(0,b.jsx)(r,{children:aj(c.warehouseId)}),(0,b.jsx)(r,{children:(a=>{switch(a){case"in_stock":return(0,b.jsx)(h.Badge,{variant:"default",className:"bg-green-100 text-green-800",children:"Còn hàng"});case"low_stock":return(0,b.jsx)(h.Badge,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:"Sắp hết"});case"out_of_stock":return(0,b.jsx)(h.Badge,{variant:"destructive",children:"Hết hàng"});default:return(0,b.jsx)(h.Badge,{variant:"outline",children:"Không xác định"})}})(c.status)}),(0,b.jsx)(r,{children:c.lastUpdated.toLocaleDateString("vi-VN")}),(0,b.jsx)(r,{className:"text-right",children:(0,b.jsxs)(k.DropdownMenu,{children:[(0,b.jsx)(k.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(f.Button,{variant:"ghost",size:"sm",children:(0,b.jsx)(B.MoreHorizontal,{className:"h-4 w-4"})})}),(0,b.jsxs)(k.DropdownMenuContent,{align:"end",children:[(0,b.jsxs)(k.DropdownMenuItem,{onClick:b=>{b.stopPropagation(),a.push(`/dashboard/inventory/${c.id}`)},children:[(0,b.jsx)(E.Eye,{className:"mr-2 h-4 w-4"}),"Xem chi tiết"]}),(0,b.jsxs)(k.DropdownMenuItem,{onClick:a=>{a.stopPropagation(),$(c),Y(!0)},children:[(0,b.jsx)(C.Edit,{className:"mr-2 h-4 w-4"}),"Chỉnh sửa"]}),(ad?.role==="admin"||ad?.permissions?.canManageInventory)&&(0,b.jsxs)(k.DropdownMenuItem,{onClick:a=>{a.stopPropagation(),aa(c)},className:"text-red-600",children:[(0,b.jsx)(D.Trash2,{className:"mr-2 h-4 w-4"}),"Xóa"]})]})]})})]},c.id))})]})]})]}),l.length>0&&(0,b.jsxs)(e.Card,{children:[(0,b.jsxs)(e.CardHeader,{children:[(0,b.jsx)(e.CardTitle,{children:"Thao tác nhanh"}),(0,b.jsx)(e.CardDescription,{children:"Các tác vụ thường dùng để quản lý hàng hóa"})]}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)(f.Button,{variant:"outline",className:"h-20 flex-col space-y-2",onClick:ag,children:[(0,b.jsx)(A.Plus,{className:"h-6 w-6"}),(0,b.jsx)("span",{children:"Thêm sản phẩm"})]}),(0,b.jsxs)(f.Button,{variant:"outline",className:"h-20 flex-col space-y-2",onClick:()=>S("low_stock"),children:[(0,b.jsx)(F.AlertTriangle,{className:"h-6 w-6"}),(0,b.jsx)("span",{children:"Sản phẩm sắp hết"})]}),(0,b.jsxs)(f.Button,{variant:"outline",className:"h-20 flex-col space-y-2",onClick:()=>S("out_of_stock"),children:[(0,b.jsx)(x.Package,{className:"h-6 w-6"}),(0,b.jsx)("span",{children:"Hàng hết tồn"})]}),(0,b.jsxs)(f.Button,{variant:"outline",className:"h-20 flex-col space-y-2",onClick:()=>a.push("/dashboard/reports"),children:[(0,b.jsx)(G.TrendingUp,{className:"h-6 w-6"}),(0,b.jsx)("span",{children:"Báo cáo tồn kho"})]})]})})]}),(0,b.jsx)(t.InventoryForm,{open:X,onClose:()=>Y(!1),onSuccess:a=>{Z?I(l.map(b=>b.id===a.id?a:b)):I([a,...l])},item:Z,mode:Z?"edit":"create"}),(0,b.jsx)(j.AlertDialog,{open:!!_,onOpenChange:()=>aa(null),children:(0,b.jsxs)(j.AlertDialogContent,{children:[(0,b.jsxs)(j.AlertDialogHeader,{children:[(0,b.jsx)(j.AlertDialogTitle,{children:"Xác nhận xóa sản phẩm"}),(0,b.jsxs)(j.AlertDialogDescription,{children:['Bạn có chắc chắn muốn xóa sản phẩm "',_?.name,'" (SKU: ',_?.sku,")?",(0,b.jsx)("br",{}),(0,b.jsx)("br",{}),(0,b.jsx)("strong",{children:"Thông tin sản phẩm:"}),(0,b.jsx)("br",{}),"• Số lượng hiện tại: ",_?.quantity,(0,b.jsx)("br",{}),"• Kho hàng: ",aj(_?.warehouseId||""),(0,b.jsx)("br",{}),(0,b.jsx)("br",{}),"Hành động này không thể hoàn tác."]})]}),(0,b.jsxs)(j.AlertDialogFooter,{children:[(0,b.jsx)(j.AlertDialogCancel,{disabled:ab,children:"Hủy"}),(0,b.jsx)(j.AlertDialogAction,{onClick:ah,disabled:ab,className:"bg-red-600 hover:bg-red-700",children:ab?"Đang xóa...":"Xóa"})]})]})})]})}}];

//# sourceMappingURL=src_app_dashboard_inventory_page_tsx_7933ac14._.js.map